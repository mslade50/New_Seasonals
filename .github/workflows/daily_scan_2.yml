name: Daily Strategy Scan

# Keeps your queue clean if GitHub lags
concurrency:
  group: ${{ github.workflow }}
  cancel-in-progress: false

on:
  schedule:
    # 1. THE ORIGINALS (Keeping Early AM and Late PM only)
    # 5:13 AM EST (10:13 UTC)
    # 4:13 PM EST (21:13 UTC)
    - cron: '45 10,21 * * 1-5'

    # 2. THE NEW HOURLY BLOCKS
    # 2:00 PM EST (19:00 UTC)
    # 3:00 PM EST (20:00 UTC)
    # - cron: '0 19,20 * * 1-5'

    # # 3. THE NEW HALF-HOUR BLOCK
    # # 3:30 PM EST (20:30 UTC)
    # - cron: '30 20 * * 1-5'

  workflow_dispatch:

jobs:
  run-scanner:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Install dependencies
        run: |
          pip install pandas numpy yfinance gspread google-auth

      - name: Run Automation Script
        env:
          GCP_JSON: ${{ secrets.GCP_JSON }}
          EMAIL_USER: ${{ secrets.EMAIL_USER }}
          EMAIL_PASS: ${{ secrets.EMAIL_PASS }}
        run: python daily_scan.py
